{
  "name" : "AnnotatedEntityHolder",
  "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder",
  "packageName" : "io.fluxzero.sdk.modeling",
  "kind" : "class",
  "modifiers" : [ "public" ],
  "annotations" : [ {
    "annotationType" : "lombok.extern.slf4j.Slf4j",
    "values" : {}
  } ],
  "documentation" : " Helper class for {@link Entity} instances that manage nested entity relationships annotated with\n {@link Member @Member}.\n <p>\n The {@code AnnotatedEntityHolder} provides a way to access and update a composite object (holder) that contains one\n or more nested entities. It supports collections, maps, and single-value member fields. It extracts member values\n using reflection and allows updating them through generated \"wither\" or \"setter\" logic, making it possible to\n reconstruct an updated parent entity when one of its children changes.\n <p>\n The holder is typically tied to a specific {@link AccessibleObject} (field or method), which is analyzed and cached\n to optimize repeated operations.\n\n <h2>Responsibilities:</h2>\n <ul>\n   <li>Extract and cache metadata about a member location (field/method), including its type, ID property, and wither.</li>\n   <li>Create {@link ImmutableEntity} instances from nested values at this member location.</li>\n   <li>Apply updates to these entities and propagate the changes back to the parent object via a wither or clone-and-set.</li>\n   <li>Support updating collection and map-based member fields while preserving immutability semantics.</li>\n </ul>\n\n <p>\n The holder is initialized and cached via {@link #getEntityHolder(Class, AccessibleObject, EntityHelper, Serializer)},\n and update logic falls back to serialization-based cloning if a wither method is not explicitly defined.\n\n @see ImmutableEntity\n @see Member\n",
  "typeParameters" : [ ],
  "superClass" : "java.lang.Object",
  "interfaces" : [ ],
  "fields" : [ {
    "name" : "cache",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.cache",
    "type" : "java.util.Map<java.lang.reflect.AccessibleObject,io.fluxzero.sdk.modeling.AnnotatedEntityHolder>",
    "modifiers" : [ "final", "private", "static" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "emptyEntity",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.emptyEntity",
    "type" : "io.fluxzero.sdk.modeling.ImmutableEntity<?>",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ {
      "annotationType" : "java.lang.SuppressWarnings",
      "values" : {
        "value" : "\"unchecked\",\"rawtypes\""
      }
    }, {
      "annotationType" : "lombok.Getter",
      "values" : {
        "lazy" : "true"
      }
    } ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "entityHelper",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.entityHelper",
    "type" : "io.fluxzero.sdk.modeling.EntityHelper",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "entityIdInvokerCache",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.entityIdInvokerCache",
    "type" : "java.util.function.Function<java.lang.Class<?>,java.util.Optional<io.fluxzero.common.reflection.MemberInvoker>>",
    "modifiers" : [ "final", "private", "static" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "entityType",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.entityType",
    "type" : "java.lang.Class<?>",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "getterPattern",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.getterPattern",
    "type" : "java.util.regex.Pattern",
    "modifiers" : [ "final", "private", "static" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "holderType",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.holderType",
    "type" : "java.lang.Class<?>",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "idProvider",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.idProvider",
    "type" : "java.util.function.Function<java.lang.Object,io.fluxzero.sdk.modeling.AnnotatedEntityHolder.Id>",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "location",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.location",
    "type" : "java.lang.reflect.AccessibleObject",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "serializer",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.serializer",
    "type" : "io.fluxzero.sdk.common.serialization.Serializer",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "wither",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder.wither",
    "type" : "java.util.function.BiFunction<java.lang.Object,java.lang.Object,java.lang.Object>",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  } ],
  "constructors" : [ {
    "name" : "AnnotatedEntityHolder",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder#AnnotatedEntityHolder",
    "modifiers" : [ "private" ],
    "annotations" : [ ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "ownerType",
      "type" : "java.lang.Class<?>",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "location",
      "type" : "java.lang.reflect.AccessibleObject",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "entityHelper",
      "type" : "io.fluxzero.sdk.modeling.EntityHelper",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "serializer",
      "type" : "io.fluxzero.sdk.common.serialization.Serializer",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  } ],
  "methods" : [ {
    "name" : "computeWither",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder#computeWither",
    "returnType" : "java.util.function.BiFunction<java.lang.Object,java.lang.Object,java.lang.Object>",
    "modifiers" : [ "private", "static" ],
    "annotations" : [ ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "ownerType",
      "type" : "java.lang.Class<?>",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "location",
      "type" : "java.lang.reflect.AccessibleObject",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "serializer",
      "type" : "io.fluxzero.sdk.common.serialization.Serializer",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "member",
      "type" : "io.fluxzero.sdk.modeling.Member",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  }, {
    "name" : "createEntity",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder#createEntity",
    "returnType" : "java.util.Optional<io.fluxzero.sdk.modeling.ImmutableEntity<?>>",
    "modifiers" : [ "private" ],
    "annotations" : [ {
      "annotationType" : "java.lang.SuppressWarnings",
      "values" : {
        "value" : "\"unchecked\""
      }
    } ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "member",
      "type" : "java.lang.Object",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "idProvider",
      "type" : "java.util.function.Function<java.lang.Object,io.fluxzero.sdk.modeling.AnnotatedEntityHolder.Id>",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "parent",
      "type" : "io.fluxzero.sdk.modeling.Entity<?>",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  }, {
    "name" : "getEntities",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder#getEntities",
    "returnType" : "java.util.stream.Stream<? extends io.fluxzero.sdk.modeling.ImmutableEntity<?>>",
    "modifiers" : [ "public" ],
    "annotations" : [ ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "parent",
      "type" : "io.fluxzero.sdk.modeling.Entity<?>",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : " Returns the set of {@link ImmutableEntity} instances that are defined at the member location within the specified\n parent entity. This includes actual members and an \"empty\" fallback entity used for creating new entities or\n assertions to carry out before an entity is created.\n\n @param parent the parent entity instance\n @return a stream of nested {@link ImmutableEntity} instances\n"
  }, {
    "name" : "getEntityHolder",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder#getEntityHolder",
    "returnType" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder",
    "modifiers" : [ "public", "static" ],
    "annotations" : [ ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "ownerType",
      "type" : "java.lang.Class<?>",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "location",
      "type" : "java.lang.reflect.AccessibleObject",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "entityHelper",
      "type" : "io.fluxzero.sdk.modeling.EntityHelper",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "serializer",
      "type" : "io.fluxzero.sdk.common.serialization.Serializer",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : " Retrieves or creates a cached {@code AnnotatedEntityHolder} at the given member location.\n\n @param ownerType    the class that owns the annotated member\n @param location     the accessible field or method annotated with @Member\n @param entityHelper the helper used to apply/validate/apply logic to nested entities\n @param serializer   the serializer used for cloning values during updates\n @return a cached or new instance of {@code AnnotatedEntityHolder}\n"
  }, {
    "name" : "updateOwner",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder#updateOwner",
    "returnType" : "java.lang.Object",
    "modifiers" : [ "public" ],
    "annotations" : [ {
      "annotationType" : "lombok.SneakyThrows",
      "values" : {}
    } ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "owner",
      "type" : "java.lang.Object",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "before",
      "type" : "io.fluxzero.sdk.modeling.Entity<?>",
      "varArgs" : false,
      "annotations" : [ ]
    }, {
      "name" : "after",
      "type" : "io.fluxzero.sdk.modeling.Entity<?>",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : " Updates the parent object with the new state of a child entity. Uses a wither method if available; otherwise\n attempts a reflective update through cloning and direct field access. If the entity has been removed (value has\n become {@code null}), the entity is removed from the owner object if possible.\n <p>\n Note that this method typically returns a new clone of the owner object containing the updated child entity\n value.\n\n @param owner  the parent object containing the member field\n @param before the old entity (before update)\n @param after  the new entity (after update)\n @return a new updated parent object, or the original if mutation fails\n"
  } ],
  "enumConstants" : [ ],
  "recordComponents" : [ ],
  "nestedTypes" : [ {
    "name" : "Id",
    "qualifiedName" : "io.fluxzero.sdk.modeling.AnnotatedEntityHolder$Id",
    "kind" : "class",
    "modifiers" : [ "private", "static" ],
    "annotations" : [ {
      "annotationType" : "lombok.Value",
      "values" : {}
    }, {
      "annotationType" : "lombok.experimental.Accessors",
      "values" : {
        "fluent" : "true"
      }
    } ]
  } ]
}
