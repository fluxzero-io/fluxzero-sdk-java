{
  "name" : "DefaultAggregateRepository",
  "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository",
  "packageName" : "io.fluxzero.sdk.persisting.repository",
  "kind" : "class",
  "modifiers" : [ "public" ],
  "annotations" : [ {
    "annotationType" : "lombok.extern.slf4j.Slf4j",
    "values" : {}
  }, {
    "annotationType" : "lombok.AllArgsConstructor",
    "values" : {}
  }, {
    "annotationType" : "lombok.Getter",
    "values" : {
      "value" : "PRIVATE"
    }
  }, {
    "annotationType" : "lombok.experimental.Accessors",
    "values" : {
      "fluent" : "true"
    }
  } ],
  "documentation" : " Default implementation of the {@link AggregateRepository} interface.\n <p>\n This class supports aggregates that are either event-sourced or document-based. Its behavior is driven by the\n {@link Aggregate @Aggregate} annotation on the aggregate class, which determines aspects such as:\n <ul>\n   <li>Whether the aggregate is event-sourced or backed by a document store.</li>\n   <li>If snapshots should be used and their frequency (via {@code snapshotPeriod}).</li>\n   <li>Whether the aggregate is searchable (indexed for queries).</li>\n   <li>Whether events should be published and how (via {@link EventPublicationStrategy}).</li>\n </ul>\n\n <p>It supports caching of aggregates and entity-aggregate relationship metadata via the provided {@link Cache} instances.\n These are consulted and updated during load and commit operations.\n\n <p>This repository coordinates with several components to manage aggregates:\n <ul>\n   <li>{@link EventStore} and {@link EventStoreClient} for storing and loading events.</li>\n   <li>{@link SnapshotStore} for loading and storing snapshots.</li>\n   <li>{@link DocumentStore} for searchable aggregates (non-event-sourced).</li>\n   <li>{@link DispatchInterceptor} to inspect or modify outgoing events before dispatch.</li>\n </ul>\n\n <p>This implementation also tracks relationships between aggregates and nested entities (e.g., value objects or sub-entities)\n and can repair these links after structural refactors using {@link #repairRelationships(Entity)}.\n\n <p>The inner {@code AnnotatedAggregateRepository<T>} class handles aggregate-specific operations by introspecting the\n annotations and metadata declared on a given aggregate type.\n\n @see Aggregate\n @see AggregateRepository\n @see Entity\n",
  "typeParameters" : [ ],
  "superClass" : "java.lang.Object",
  "interfaces" : [ "io.fluxzero.sdk.persisting.repository.AggregateRepository" ],
  "fields" : [ {
    "name" : "aggregateCache",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.aggregateCache",
    "type" : "io.fluxzero.sdk.persisting.caching.Cache",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "delegates",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.delegates",
    "type" : "java.util.function.Function<java.lang.Class<?>,io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.AnnotatedAggregateRepository<?>>",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "dispatchInterceptor",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.dispatchInterceptor",
    "type" : "io.fluxzero.sdk.publishing.DispatchInterceptor",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "documentStore",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.documentStore",
    "type" : "io.fluxzero.sdk.persisting.search.DocumentStore",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "entityHelper",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.entityHelper",
    "type" : "io.fluxzero.sdk.modeling.EntityHelper",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "eventStore",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.eventStore",
    "type" : "io.fluxzero.sdk.persisting.eventsourcing.EventStore",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "eventStoreClient",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.eventStoreClient",
    "type" : "io.fluxzero.sdk.persisting.eventsourcing.client.EventStoreClient",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "relationshipsCache",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.relationshipsCache",
    "type" : "io.fluxzero.sdk.persisting.caching.Cache",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "serializer",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.serializer",
    "type" : "io.fluxzero.sdk.common.serialization.Serializer",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  }, {
    "name" : "snapshotStore",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository.snapshotStore",
    "type" : "io.fluxzero.sdk.persisting.eventsourcing.SnapshotStore",
    "modifiers" : [ "final", "private" ],
    "annotations" : [ ],
    "documentation" : null,
    "constantValue" : null
  } ],
  "constructors" : [ {
    "name" : "DefaultAggregateRepository",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository#DefaultAggregateRepository",
    "modifiers" : [ "public" ],
    "annotations" : [ ],
    "typeParameters" : [ ],
    "parameters" : [ ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  } ],
  "methods" : [ {
    "name" : "asEntity",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository#asEntity",
    "returnType" : "io.fluxzero.sdk.modeling.Entity<T>",
    "modifiers" : [ "public" ],
    "annotations" : [ {
      "annotationType" : "java.lang.Override",
      "values" : {}
    }, {
      "annotationType" : "java.lang.SuppressWarnings",
      "values" : {
        "value" : "\"unchecked\""
      }
    } ],
    "typeParameters" : [ "T" ],
    "parameters" : [ {
      "name" : "entityValue",
      "type" : "T",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  }, {
    "name" : "deleteAggregate",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository#deleteAggregate",
    "returnType" : "java.util.concurrent.CompletableFuture<java.lang.Void>",
    "modifiers" : [ "public" ],
    "annotations" : [ {
      "annotationType" : "java.lang.Override",
      "values" : {}
    } ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "aggregateId",
      "type" : "java.lang.Object",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  }, {
    "name" : "getAggregatesFor",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository#getAggregatesFor",
    "returnType" : "java.util.Map<java.lang.String,java.lang.Class<?>>",
    "modifiers" : [ "public" ],
    "annotations" : [ {
      "annotationType" : "java.lang.Override",
      "values" : {}
    }, {
      "annotationType" : "java.lang.SuppressWarnings",
      "values" : {
        "value" : "\"Java8MapForEach\""
      }
    } ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "entityId",
      "type" : "java.lang.@lombok.NonNull Object",
      "varArgs" : false,
      "annotations" : [ {
        "annotationType" : "lombok.NonNull",
        "values" : {}
      } ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  }, {
    "name" : "load",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository#load",
    "returnType" : "io.fluxzero.sdk.modeling.Entity<T>",
    "modifiers" : [ "public" ],
    "annotations" : [ {
      "annotationType" : "java.lang.Override",
      "values" : {}
    }, {
      "annotationType" : "java.lang.SuppressWarnings",
      "values" : {
        "value" : "\"unchecked\""
      }
    } ],
    "typeParameters" : [ "T" ],
    "parameters" : [ {
      "name" : "aggregateId",
      "type" : "java.lang.@lombok.NonNull Object",
      "varArgs" : false,
      "annotations" : [ {
        "annotationType" : "lombok.NonNull",
        "values" : {}
      } ]
    }, {
      "name" : "type",
      "type" : "java.lang.Class<T>",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  }, {
    "name" : "loadFor",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository#loadFor",
    "returnType" : "io.fluxzero.sdk.modeling.Entity<T>",
    "modifiers" : [ "public" ],
    "annotations" : [ {
      "annotationType" : "java.lang.SuppressWarnings",
      "values" : {
        "value" : "\"unchecked\""
      }
    }, {
      "annotationType" : "java.lang.Override",
      "values" : {}
    } ],
    "typeParameters" : [ "T" ],
    "parameters" : [ {
      "name" : "entityId",
      "type" : "java.lang.@lombok.NonNull Object",
      "varArgs" : false,
      "annotations" : [ {
        "annotationType" : "lombok.NonNull",
        "values" : {}
      } ]
    }, {
      "name" : "defaultType",
      "type" : "java.lang.Class<?>",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  }, {
    "name" : "repairRelationships",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository#repairRelationships",
    "returnType" : "java.util.concurrent.CompletableFuture<java.lang.Void>",
    "modifiers" : [ "public" ],
    "annotations" : [ {
      "annotationType" : "java.lang.Override",
      "values" : {}
    } ],
    "typeParameters" : [ ],
    "parameters" : [ {
      "name" : "aggregate",
      "type" : "io.fluxzero.sdk.modeling.Entity<?>",
      "varArgs" : false,
      "annotations" : [ ]
    } ],
    "thrownTypes" : [ ],
    "varArgs" : false,
    "documentation" : null
  } ],
  "enumConstants" : [ ],
  "recordComponents" : [ ],
  "nestedTypes" : [ {
    "name" : "AnnotatedAggregateRepository",
    "qualifiedName" : "io.fluxzero.sdk.persisting.repository.DefaultAggregateRepository$AnnotatedAggregateRepository",
    "kind" : "class",
    "modifiers" : [ "public" ],
    "annotations" : [ ]
  } ]
}
