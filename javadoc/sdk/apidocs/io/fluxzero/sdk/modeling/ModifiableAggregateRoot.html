<!DOCTYPE HTML>
<html lang>
<head>
<meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<!-- Generated by javadoc (25) on Thu Dec 18 14:51:09 UTC 2025 -->
<title>ModifiableAggregateRoot (io.fluxzero:sdk 1.57.1 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-12-18">
<meta name="description" content="declaration: package: io.fluxzero.sdk.modeling, class: ModifiableAggregateRoot">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/ModifiableAggregateRoot.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../search.html">Search</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">io.fluxzero.sdk.modeling</a></li>
<li><a href="ModifiableAggregateRoot.html" class="current-selection">ModifiableAggregateRoot</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a>
<ol class="toc-list">
<li><a href="#commit-lifecycle-heading" tabindex="0">Commit Lifecycle</a></li>
<li><a href="#publication-strategy-heading" tabindex="0">Publication Strategy</a></li>
<li><a href="#thread-scoped-aggregates-heading" tabindex="0">Thread-Scoped Aggregates</a></li>
</ol>
</li>
<li><a href="#nested-class-summary" tabindex="0">Nested Class Summary</a></li>
<li><a href="#field-summary" tabindex="0">Field Summary</a></li>
<li><a href="#constructor-summary" tabindex="0">Constructor Summary</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#constructor-detail" tabindex="0">Constructor Details</a>
<ol class="toc-list">
<li><a href="#%3Cinit%3E(io.fluxzero.sdk.modeling.Entity,boolean,io.fluxzero.sdk.modeling.EventPublication,io.fluxzero.sdk.modeling.EventPublicationStrategy,io.fluxzero.sdk.modeling.EntityHelper,io.fluxzero.sdk.common.serialization.Serializer,io.fluxzero.sdk.publishing.DispatchInterceptor,io.fluxzero.sdk.modeling.ModifiableAggregateRoot.CommitHandler)" tabindex="0">ModifiableAggregateRoot(Entity, boolean, EventPublication, EventPublicationStrategy, EntityHelper, Serializer, DispatchInterceptor, ModifiableAggregateRoot.CommitHandler)</a></li>
</ol>
</li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#getIfActive(java.lang.Object)" tabindex="0">getIfActive(Object)</a></li>
<li><a href="#getActiveAggregatesFor(java.lang.Object)" tabindex="0">getActiveAggregatesFor(Object)</a></li>
<li><a href="#load(java.lang.Object,java.util.function.Supplier,boolean,io.fluxzero.sdk.modeling.EventPublication,io.fluxzero.sdk.modeling.EventPublicationStrategy,io.fluxzero.sdk.modeling.EntityHelper,io.fluxzero.sdk.common.serialization.Serializer,io.fluxzero.sdk.publishing.DispatchInterceptor,io.fluxzero.sdk.modeling.ModifiableAggregateRoot.CommitHandler)" tabindex="0">load(Object, Supplier, boolean, EventPublication, EventPublicationStrategy, EntityHelper, Serializer, DispatchInterceptor, ModifiableAggregateRoot.CommitHandler)</a></li>
<li><a href="#assertLegal(java.lang.Object)" tabindex="0">assertLegal(Object)</a></li>
<li><a href="#assertAndApply(java.lang.Object)" tabindex="0">assertAndApply(Object)</a></li>
<li><a href="#update(java.util.function.UnaryOperator)" tabindex="0">update(UnaryOperator)</a></li>
<li><a href="#apply(io.fluxzero.sdk.common.Message)" tabindex="0">apply(Message)</a></li>
<li><a href="#apply(io.fluxzero.sdk.common.Message,boolean)" tabindex="0">apply(Message, boolean)</a></li>
<li><a href="#handleUpdate(java.util.function.UnaryOperator)" tabindex="0">handleUpdate(UnaryOperator)</a></li>
<li><a href="#whenHandlerCompletes(java.lang.Throwable)" tabindex="0">whenHandlerCompletes(Throwable)</a></li>
<li><a href="#commitAndClear()" tabindex="0">commitAndClear()</a></li>
<li><a href="#commit()" tabindex="0">commit()</a></li>
<li><a href="#commit(boolean)" tabindex="0">commit(boolean)</a></li>
<li><a href="#entities()" tabindex="0">entities()</a></li>
<li><a href="#previous()" tabindex="0">previous()</a></li>
</ol>
</li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class ModifiableAggregateRoot" class="title">Class ModifiableAggregateRoot&lt;T&gt;</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="DelegatingEntity.html" title="class in io.fluxzero.sdk.modeling">io.fluxzero.sdk.modeling.DelegatingEntity</a>&lt;T&gt;
<div class="inheritance">io.fluxzero.sdk.modeling.ModifiableAggregateRoot&lt;T&gt;</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Type Parameters:</dt>
<dd><span id="type-param-T"><code>T</code> - the type of the aggregate's value.</span></dd>
</dl>
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="AggregateRoot.html" title="interface in io.fluxzero.sdk.modeling">AggregateRoot</a>&lt;T&gt;, <a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;T&gt;</code></dd>
</dl>
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">ModifiableAggregateRoot&lt;T&gt;</span>
<span class="extends-implements">extends <a href="DelegatingEntity.html" title="class in io.fluxzero.sdk.modeling">DelegatingEntity</a>&lt;T&gt;
implements <a href="AggregateRoot.html" title="interface in io.fluxzero.sdk.modeling">AggregateRoot</a>&lt;T&gt;</span></div>
<div class="block">A mutable, stateful <a href="AggregateRoot.html" title="interface in io.fluxzero.sdk.modeling"><code>AggregateRoot</code></a> implementation that allows in-place updates and applies events with commit
support for persisting the state and synchronizing it with the Fluxzero Runtime.
<p>
This class acts as a wrapper around an immutable entity (typically an <a href="ImmutableAggregateRoot.html" title="class in io.fluxzero.sdk.modeling"><code>ImmutableAggregateRoot</code></a>), providing
additional lifecycle management for:
<ul>
    <li>Capturing uncommitted changes during an event or command handler execution.</li>
    <li>Intercepting and applying updates and events with legality assertions.</li>
    <li>Buffering applied events and committing them via a <a href="ModifiableAggregateRoot.CommitHandler.html" title="interface in io.fluxzero.sdk.modeling"><code>ModifiableAggregateRoot.CommitHandler</code></a> callback.</li>
    <li>Supporting batch-commit semantics for grouped event processing.</li>
    <li>Tracking active aggregates for correlation and relationship resolution during handlers.</li>
</ul>

<h2 id="commit-lifecycle-heading">Commit Lifecycle</h2>
During handler invocation, intercepted updates and applied events are stored in a temporary buffer.
When the handler completes successfully, events are committed via the configured <a href="ModifiableAggregateRoot.CommitHandler.html" title="interface in io.fluxzero.sdk.modeling"><code>ModifiableAggregateRoot.CommitHandler</code></a>,
which typically stores events in the <a href="../persisting/eventsourcing/EventStore.html" title="interface in io.fluxzero.sdk.persisting.eventsourcing"><code>EventStore</code></a> and
publishes them if needed.
<p>
If the handler fails (throws), state changes and captured events are discarded, and the aggregate is rolled
back to the last stable state.

<h2 id="publication-strategy-heading">Publication Strategy</h2>
Events are published according to the <a href="EventPublication.html" title="enum class in io.fluxzero.sdk.modeling"><code>EventPublication</code></a> and <a href="EventPublicationStrategy.html" title="enum class in io.fluxzero.sdk.modeling"><code>EventPublicationStrategy</code></a> specified
either globally or on individual <a href="../persisting/eventsourcing/Apply.html" title="annotation interface in io.fluxzero.sdk.persisting.eventsourcing"><code>Apply</code></a>-annotated methods. This allows
fine-grained control over which events are stored or published.

<h2 id="thread-scoped-aggregates-heading">Thread-Scoped Aggregates</h2>
All active <code>ModifiableAggregateRoot</code> instances are tracked per thread using a thread-local map,
enabling relationship resolution and update tracking across aggregates within the same handler context.
<p>
This mechanism enables other parts of the framework to determine which aggregates are currently in use
or updated within a processing thread, without requiring external state.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="ImmutableAggregateRoot.html" title="class in io.fluxzero.sdk.modeling"><code>ImmutableAggregateRoot</code></a></li>
<li><a href="LazyAggregateRoot.html" title="class in io.fluxzero.sdk.modeling"><code>LazyAggregateRoot</code></a></li>
<li><a href="ModifiableAggregateRoot.CommitHandler.html" title="interface in io.fluxzero.sdk.modeling"><code>ModifiableAggregateRoot.CommitHandler</code></a></li>
<li><a href="EventPublication.html" title="enum class in io.fluxzero.sdk.modeling"><code>EventPublication</code></a></li>
<li><a href="EventPublicationStrategy.html" title="enum class in io.fluxzero.sdk.modeling"><code>EventPublicationStrategy</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ModifiableAggregateRoot.CommitHandler.html" class="type-name-link" title="interface in io.fluxzero.sdk.modeling">ModifiableAggregateRoot.CommitHandler</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-io.fluxzero.sdk.modeling.DelegatingEntity">Fields inherited from class&nbsp;<a href="DelegatingEntity.html#field-summary" title="class in io.fluxzero.sdk.modeling">DelegatingEntity</a></h3>
<code><a href="DelegatingEntity.html#delegate">delegate</a></code></div>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-io.fluxzero.sdk.modeling.Entity">Fields inherited from interface&nbsp;<a href="Entity.html#field-summary" title="interface in io.fluxzero.sdk.modeling">Entity</a></h3>
<code><a href="Entity.html#AGGREGATE_ID_METADATA_KEY">AGGREGATE_ID_METADATA_KEY</a>, <a href="Entity.html#AGGREGATE_SN_METADATA_KEY">AGGREGATE_SN_METADATA_KEY</a>, <a href="Entity.html#AGGREGATE_TYPE_METADATA_KEY">AGGREGATE_TYPE_METADATA_KEY</a>, <a href="Entity.html#applying">applying</a>, <a href="Entity.html#loading">loading</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier</div>
<div class="table-header col-second">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected </code></div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(io.fluxzero.sdk.modeling.Entity,boolean,io.fluxzero.sdk.modeling.EventPublication,io.fluxzero.sdk.modeling.EventPublicationStrategy,io.fluxzero.sdk.modeling.EntityHelper,io.fluxzero.sdk.common.serialization.Serializer,io.fluxzero.sdk.publishing.DispatchInterceptor,io.fluxzero.sdk.modeling.ModifiableAggregateRoot.CommitHandler)" class="member-name-link">ModifiableAggregateRoot</a><wbr>(<a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;&nbsp;delegate,
 boolean&nbsp;commitInBatch,
 <a href="EventPublication.html" title="enum class in io.fluxzero.sdk.modeling">EventPublication</a>&nbsp;eventPublication,
 <a href="EventPublicationStrategy.html" title="enum class in io.fluxzero.sdk.modeling">EventPublicationStrategy</a>&nbsp;publicationStrategy,
 <a href="EntityHelper.html" title="interface in io.fluxzero.sdk.modeling">EntityHelper</a>&nbsp;entityHelper,
 <a href="../common/serialization/Serializer.html" title="interface in io.fluxzero.sdk.common.serialization">Serializer</a>&nbsp;serializer,
 <a href="../publishing/DispatchInterceptor.html" title="interface in io.fluxzero.sdk.publishing">DispatchInterceptor</a>&nbsp;dispatchInterceptor,
 <a href="ModifiableAggregateRoot.CommitHandler.html" title="interface in io.fluxzero.sdk.modeling">ModifiableAggregateRoot.CommitHandler</a>&nbsp;commitHandler)</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#apply(io.fluxzero.sdk.common.Message)" class="member-name-link">apply</a><wbr>(<a href="../common/Message.html" title="class in io.fluxzero.sdk.common">Message</a>&nbsp;message)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Applies the given message to the entity.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#apply(io.fluxzero.sdk.common.Message,boolean)" class="member-name-link">apply</a><wbr>(<a href="../common/Message.html" title="class in io.fluxzero.sdk.common">Message</a>&nbsp;message,
 boolean&nbsp;assertLegal)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#assertAndApply(java.lang.Object)" class="member-name-link">assertAndApply</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;payloadOrMessage)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies that the provided update is legal given the current state of the aggregate and on success applies it to
the aggregate.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>&lt;E extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>&gt;<br><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#assertLegal(java.lang.Object)" class="member-name-link">assertLegal</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;update)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies that the provided update is legal given the current state of the aggregate.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#commit()" class="member-name-link">commit</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Commits the current state of the entity, persisting any changes made to it.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#commit(boolean)" class="member-name-link">commit</a><wbr>(boolean&nbsp;async)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#commitAndClear()" class="member-name-link">commitAndClear</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a><wbr>&lt;? extends <a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;?&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#entities()" class="member-name-link">entities</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves child entities of this entity.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getActiveAggregatesFor(java.lang.Object)" class="member-name-link">getActiveAggregatesFor</a><wbr>(@NonNull <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;entityId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a><wbr>&lt;<a href="ModifiableAggregateRoot.html" title="class in io.fluxzero.sdk.modeling">ModifiableAggregateRoot</a>&lt;T&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getIfActive(java.lang.Object)" class="member-name-link">getIfActive</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleUpdate(java.util.function.UnaryOperator)" class="member-name-link">handleUpdate</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/UnaryOperator.html" title="class or interface in java.util.function" class="external-link">UnaryOperator</a>&lt;<a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;&gt;&nbsp;update)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;<a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;T&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#load(java.lang.Object,java.util.function.Supplier,boolean,io.fluxzero.sdk.modeling.EventPublication,io.fluxzero.sdk.modeling.EventPublicationStrategy,io.fluxzero.sdk.modeling.EntityHelper,io.fluxzero.sdk.common.serialization.Serializer,io.fluxzero.sdk.publishing.DispatchInterceptor,io.fluxzero.sdk.modeling.ModifiableAggregateRoot.CommitHandler)" class="member-name-link">load</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;<a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;T&gt;&gt;&nbsp;loader,
 boolean&nbsp;commitInBatch,
 <a href="EventPublication.html" title="enum class in io.fluxzero.sdk.modeling">EventPublication</a>&nbsp;eventPublication,
 <a href="EventPublicationStrategy.html" title="enum class in io.fluxzero.sdk.modeling">EventPublicationStrategy</a>&nbsp;publicationStrategy,
 <a href="EntityHelper.html" title="interface in io.fluxzero.sdk.modeling">EntityHelper</a>&nbsp;entityHelper,
 <a href="../common/serialization/Serializer.html" title="interface in io.fluxzero.sdk.common.serialization">Serializer</a>&nbsp;serializer,
 <a href="../publishing/DispatchInterceptor.html" title="interface in io.fluxzero.sdk.publishing">DispatchInterceptor</a>&nbsp;dispatchInterceptor,
 <a href="ModifiableAggregateRoot.CommitHandler.html" title="interface in io.fluxzero.sdk.modeling">ModifiableAggregateRoot.CommitHandler</a>&nbsp;commitHandler)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#previous()" class="member-name-link">previous</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Retrieves the previous version of this entity.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a><wbr>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#update(java.util.function.UnaryOperator)" class="member-name-link">update</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/UnaryOperator.html" title="class or interface in java.util.function" class="external-link">UnaryOperator</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;&nbsp;function)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Updates the current entity's value using the specified unary operator and returns a new entity containing the
updated value.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#whenHandlerCompletes(java.lang.Throwable)" class="member-name-link">whenHandlerCompletes</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&nbsp;error)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-io.fluxzero.sdk.modeling.DelegatingEntity">Methods inherited from class&nbsp;<a href="DelegatingEntity.html#method-summary" title="class in io.fluxzero.sdk.modeling">DelegatingEntity</a></h3>
<code><a href="DelegatingEntity.html#aliases()" title="aliases()">aliases</a>, <a href="DelegatingEntity.html#get()" title="get()">get</a>, <a href="DelegatingEntity.html#id()" title="id()">id</a>, <a href="DelegatingEntity.html#idProperty()" title="idProperty()">idProperty</a>, <a href="DelegatingEntity.html#lastEventId()" title="lastEventId()">lastEventId</a>, <a href="DelegatingEntity.html#lastEventIndex()" title="lastEventIndex()">lastEventIndex</a>, <a href="DelegatingEntity.html#parent()" title="parent()">parent</a>, <a href="DelegatingEntity.html#sequenceNumber()" title="sequenceNumber()">sequenceNumber</a>, <a href="DelegatingEntity.html#timestamp()" title="timestamp()">timestamp</a>, <a href="DelegatingEntity.html#type()" title="type()">type</a>, <a href="DelegatingEntity.html#withEventIndex(java.lang.Long,java.lang.String)" title="withEventIndex(Long, String)">withEventIndex</a>, <a href="DelegatingEntity.html#withSequenceNumber(long)" title="withSequenceNumber(long)">withSequenceNumber</a>, <a href="DelegatingEntity.html#withType(java.lang.Class)" title="withType(Class)">withType</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#method-summary" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-io.fluxzero.sdk.modeling.AggregateRoot">Methods inherited from interface&nbsp;<a href="AggregateRoot.html#method-summary" title="interface in io.fluxzero.sdk.modeling">AggregateRoot</a></h3>
<code><a href="AggregateRoot.html#lastEventId()" title="lastEventId()">lastEventId</a>, <a href="AggregateRoot.html#lastEventIndex()" title="lastEventIndex()">lastEventIndex</a>, <a href="AggregateRoot.html#parent()" title="parent()">parent</a>, <a href="AggregateRoot.html#sequenceNumber()" title="sequenceNumber()">sequenceNumber</a>, <a href="AggregateRoot.html#timestamp()" title="timestamp()">timestamp</a>, <a href="AggregateRoot.html#withEventIndex(java.lang.Long,java.lang.String)" title="withEventIndex(Long, String)">withEventIndex</a>, <a href="AggregateRoot.html#withSequenceNumber(long)" title="withSequenceNumber(long)">withSequenceNumber</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-io.fluxzero.sdk.modeling.Entity">Methods inherited from interface&nbsp;<a href="Entity.html#method-summary" title="interface in io.fluxzero.sdk.modeling">Entity</a></h3>
<code><a href="Entity.html#aliases()" title="aliases()">aliases</a>, <a href="Entity.html#allEntities()" title="allEntities()">allEntities</a>, <a href="Entity.html#ancestors()" title="ancestors()">ancestors</a>, <a href="Entity.html#ancestorValue(java.lang.Class)" title="ancestorValue(Class)">ancestorValue</a>, <a href="Entity.html#apply(io.fluxzero.sdk.common.serialization.DeserializingMessage)" title="apply(DeserializingMessage)">apply</a>, <a href="Entity.html#apply(java.lang.Object)" title="apply(Object)">apply</a>, <a href="Entity.html#apply(java.lang.Object...)" title="apply(Object...)">apply</a>, <a href="Entity.html#apply(java.lang.Object,io.fluxzero.common.api.Metadata)" title="apply(Object, Metadata)">apply</a>, <a href="Entity.html#apply(java.util.Collection)" title="apply(Collection)">apply</a>, <a href="Entity.html#assertAndApply(java.lang.Object...)" title="assertAndApply(Object...)">assertAndApply</a>, <a href="Entity.html#assertAndApply(java.lang.Object,io.fluxzero.common.api.Metadata)" title="assertAndApply(Object, Metadata)">assertAndApply</a>, <a href="Entity.html#assertAndApply(java.util.Collection)" title="assertAndApply(Collection)">assertAndApply</a>, <a href="Entity.html#associations(io.fluxzero.sdk.modeling.Entity)" title="associations(Entity)">associations</a>, <a href="Entity.html#depth()" title="depth()">depth</a>, <a href="Entity.html#dissociations(io.fluxzero.sdk.modeling.Entity)" title="dissociations(Entity)">dissociations</a>, <a href="Entity.html#get()" title="get()">get</a>, <a href="Entity.html#getEntity(java.lang.Object)" title="getEntity(Object)">getEntity</a>, <a href="Entity.html#highestEventIndex()" title="highestEventIndex()">highestEventIndex</a>, <a href="Entity.html#id()" title="id()">id</a>, <a href="Entity.html#idProperty()" title="idProperty()">idProperty</a>, <a href="Entity.html#ifPresent(java.util.function.UnaryOperator)" title="ifPresent(UnaryOperator)">ifPresent</a>, <a href="Entity.html#isEmpty()" title="isEmpty()">isEmpty</a>, <a href="Entity.html#isPresent()" title="isPresent()">isPresent</a>, <a href="Entity.html#isRoot()" title="isRoot()">isRoot</a>, <a href="Entity.html#mapIfPresent(java.util.function.Function)" title="mapIfPresent(Function)">mapIfPresent</a>, <a href="Entity.html#playBackToCondition(java.util.function.Predicate)" title="playBackToCondition(Predicate)">playBackToCondition</a>, <a href="Entity.html#playBackToEvent(java.lang.Long,java.lang.String)" title="playBackToEvent(Long, String)">playBackToEvent</a>, <a href="Entity.html#possibleTargets(java.lang.Object)" title="possibleTargets(Object)">possibleTargets</a>, <a href="Entity.html#relationships()" title="relationships()">relationships</a>, <a href="Entity.html#root()" title="root()">root</a>, <a href="Entity.html#rootAnnotation()" title="rootAnnotation()">rootAnnotation</a>, <a href="Entity.html#type()" title="type()">type</a>, <a href="Entity.html#withType(java.lang.Class)" title="withType(Class)">withType</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(io.fluxzero.sdk.modeling.Entity,boolean,io.fluxzero.sdk.modeling.EventPublication,io.fluxzero.sdk.modeling.EventPublicationStrategy,io.fluxzero.sdk.modeling.EntityHelper,io.fluxzero.sdk.common.serialization.Serializer,io.fluxzero.sdk.publishing.DispatchInterceptor,io.fluxzero.sdk.modeling.ModifiableAggregateRoot.CommitHandler)">
<h3>ModifiableAggregateRoot</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="element-name">ModifiableAggregateRoot</span><wbr><span class="parameters">(<a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;&nbsp;delegate,
 boolean&nbsp;commitInBatch,
 <a href="EventPublication.html" title="enum class in io.fluxzero.sdk.modeling">EventPublication</a>&nbsp;eventPublication,
 <a href="EventPublicationStrategy.html" title="enum class in io.fluxzero.sdk.modeling">EventPublicationStrategy</a>&nbsp;publicationStrategy,
 <a href="EntityHelper.html" title="interface in io.fluxzero.sdk.modeling">EntityHelper</a>&nbsp;entityHelper,
 <a href="../common/serialization/Serializer.html" title="interface in io.fluxzero.sdk.common.serialization">Serializer</a>&nbsp;serializer,
 <a href="../publishing/DispatchInterceptor.html" title="interface in io.fluxzero.sdk.publishing">DispatchInterceptor</a>&nbsp;dispatchInterceptor,
 <a href="ModifiableAggregateRoot.CommitHandler.html" title="interface in io.fluxzero.sdk.modeling">ModifiableAggregateRoot.CommitHandler</a>&nbsp;commitHandler)</span></div>
</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getIfActive(java.lang.Object)">
<h3>getIfActive</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>
<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="ModifiableAggregateRoot.html" title="class in io.fluxzero.sdk.modeling">ModifiableAggregateRoot</a>&lt;T&gt;&gt;</span>&nbsp;<span class="element-name">getIfActive</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId)</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="getActiveAggregatesFor(java.lang.Object)">
<h3>getActiveAggregatesFor</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;&gt;</span>&nbsp;<span class="element-name">getActiveAggregatesFor</span><wbr><span class="parameters">(@NonNull
 @NonNull <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;entityId)</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="load(java.lang.Object,java.util.function.Supplier,boolean,io.fluxzero.sdk.modeling.EventPublication,io.fluxzero.sdk.modeling.EventPublicationStrategy,io.fluxzero.sdk.modeling.EntityHelper,io.fluxzero.sdk.common.serialization.Serializer,io.fluxzero.sdk.publishing.DispatchInterceptor,io.fluxzero.sdk.modeling.ModifiableAggregateRoot.CommitHandler)">
<h3>load</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;T&gt;</span>&nbsp;<span class="element-name">load</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;aggregateId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Supplier.html" title="class or interface in java.util.function" class="external-link">Supplier</a>&lt;<a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;T&gt;&gt;&nbsp;loader,
 boolean&nbsp;commitInBatch,
 <a href="EventPublication.html" title="enum class in io.fluxzero.sdk.modeling">EventPublication</a>&nbsp;eventPublication,
 <a href="EventPublicationStrategy.html" title="enum class in io.fluxzero.sdk.modeling">EventPublicationStrategy</a>&nbsp;publicationStrategy,
 <a href="EntityHelper.html" title="interface in io.fluxzero.sdk.modeling">EntityHelper</a>&nbsp;entityHelper,
 <a href="../common/serialization/Serializer.html" title="interface in io.fluxzero.sdk.common.serialization">Serializer</a>&nbsp;serializer,
 <a href="../publishing/DispatchInterceptor.html" title="interface in io.fluxzero.sdk.publishing">DispatchInterceptor</a>&nbsp;dispatchInterceptor,
 <a href="ModifiableAggregateRoot.CommitHandler.html" title="interface in io.fluxzero.sdk.modeling">ModifiableAggregateRoot.CommitHandler</a>&nbsp;commitHandler)</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="assertLegal(java.lang.Object)">
<h3>assertLegal</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;E extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>&gt;</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">assertLegal</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;update)</span>
                                            throws <span class="exceptions">E</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="Entity.html#assertLegal(java.lang.Object)">Entity</a></code></span></div>
<div class="block">Verifies that the provided update is legal given the current state of the aggregate. If so, the entity is
returned; otherwise, it throws an appropriate exception.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Entity.html#assertLegal(java.lang.Object)">assertLegal</a></code>&nbsp;in interface&nbsp;<code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Type Parameters:</dt>
<dd><span id="assertLegal(java.lang.Object)-type-param-E"><code>E</code> - the type of exception expected if the update is not legal</span></dd>
<dt>Parameters:</dt>
<dd><code>update</code> - the update to be validated for compliance with the required rules</dd>
<dt>Returns:</dt>
<dd>the entity if the update is legal</dd>
<dt>Throws:</dt>
<dd><code>E</code> - if the update fails to meet legal requirements</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="assertAndApply(java.lang.Object)">
<h3>assertAndApply</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">assertAndApply</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;payloadOrMessage)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="Entity.html#assertAndApply(java.lang.Object)">Entity</a></code></span></div>
<div class="block">Verifies that the provided update is legal given the current state of the aggregate and on success applies it to
the aggregate. If not, it throws an appropriate exception.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Entity.html#assertAndApply(java.lang.Object)">assertAndApply</a></code>&nbsp;in interface&nbsp;<code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>payloadOrMessage</code> - the input object to be applied; can be a payload or a message</dd>
<dt>Returns:</dt>
<dd>the resulting entity after application</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="update(java.util.function.UnaryOperator)">
<h3>update</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">update</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/UnaryOperator.html" title="class or interface in java.util.function" class="external-link">UnaryOperator</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;&nbsp;function)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="Entity.html#update(java.util.function.UnaryOperator)">Entity</a></code></span></div>
<div class="block">Updates the current entity's value using the specified unary operator and returns a new entity containing the
updated value.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Entity.html#update(java.util.function.UnaryOperator)">update</a></code>&nbsp;in interface&nbsp;<code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>function</code> - the unary operator to apply to the current entity's value</dd>
<dt>Returns:</dt>
<dd>a new entity containing the updated value after applying the function</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="apply(io.fluxzero.sdk.common.Message)">
<h3>apply</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">apply</span><wbr><span class="parameters">(<a href="../common/Message.html" title="class in io.fluxzero.sdk.common">Message</a>&nbsp;message)</span></div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="Entity.html#apply(io.fluxzero.sdk.common.Message)">Entity</a></code></span></div>
<div class="block">Applies the given message to the entity.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Entity.html#apply(io.fluxzero.sdk.common.Message)">apply</a></code>&nbsp;in interface&nbsp;<code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Parameters:</dt>
<dd><code>message</code> - the message representing the event to be applied</dd>
<dt>Returns:</dt>
<dd>the updated or newly created Entity of type T</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="apply(io.fluxzero.sdk.common.Message,boolean)">
<h3>apply</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">apply</span><wbr><span class="parameters">(<a href="../common/Message.html" title="class in io.fluxzero.sdk.common">Message</a>&nbsp;message,
 boolean&nbsp;assertLegal)</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="handleUpdate(java.util.function.UnaryOperator)">
<h3>handleUpdate</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">handleUpdate</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/UnaryOperator.html" title="class or interface in java.util.function" class="external-link">UnaryOperator</a>&lt;<a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;&gt;&nbsp;update)</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="whenHandlerCompletes(java.lang.Throwable)">
<h3>whenHandlerCompletes</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">whenHandlerCompletes</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&nbsp;error)</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="commitAndClear()">
<h3>commitAndClear</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">commitAndClear</span>()</div>
</div>
</section>
</li>
<li>
<section class="detail" id="commit()">
<h3>commit</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">commit</span>()</div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="Entity.html#commit()">Entity</a></code></span></div>
<div class="block">Commits the current state of the entity, persisting any changes made to it. This method ensures that the
modifications are saved. Typically, it is unnecessary to invoke this manually as it is automatically invoked
after the current handler or consumer batch has completed.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Entity.html#commit()">commit</a></code>&nbsp;in interface&nbsp;<code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Returns:</dt>
<dd>The updated entity after the commit operation is successfully completed.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="commit(boolean)">
<h3>commit</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">commit</span><wbr><span class="parameters">(boolean&nbsp;async)</span></div>
</div>
</section>
</li>
<li>
<section class="detail" id="entities()">
<h3>entities</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;? extends <a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;?&gt;&gt;</span>&nbsp;<span class="element-name">entities</span>()</div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="Entity.html#entities()">Entity</a></code></span></div>
<div class="block">Retrieves child entities of this entity.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Entity.html#entities()">entities</a></code>&nbsp;in interface&nbsp;<code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Overrides:</dt>
<dd><code><a href="DelegatingEntity.html#entities()">entities</a></code>&nbsp;in class&nbsp;<code><a href="DelegatingEntity.html" title="class in io.fluxzero.sdk.modeling">DelegatingEntity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Returns:</dt>
<dd>a collection containing child entities.</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="previous()">
<h3>previous</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</span>&nbsp;<span class="element-name">previous</span>()</div>
<div class="block"><span class="description-from-type-label">Description copied from interface:&nbsp;<code><a href="Entity.html#previous()">Entity</a></code></span></div>
<div class="block">Retrieves the previous version of this entity.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="AggregateRoot.html#previous()">previous</a></code>&nbsp;in interface&nbsp;<code><a href="AggregateRoot.html" title="interface in io.fluxzero.sdk.modeling">AggregateRoot</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Specified by:</dt>
<dd><code><a href="Entity.html#previous()">previous</a></code>&nbsp;in interface&nbsp;<code><a href="Entity.html" title="interface in io.fluxzero.sdk.modeling">Entity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Overrides:</dt>
<dd><code><a href="DelegatingEntity.html#previous()">previous</a></code>&nbsp;in class&nbsp;<code><a href="DelegatingEntity.html" title="class in io.fluxzero.sdk.modeling">DelegatingEntity</a>&lt;<a href="#type-param-T" title="type parameter in ModifiableAggregateRoot">T</a>&gt;</code></dd>
<dt>Returns:</dt>
<dd>the previous state of the entity, or null if this is the first known version</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025 <a href="https://github.com/fluxzero-io/fluxzero-sdk-java">Fluxzero</a>. All rights reserved.</small></p>
</footer>
</main>
</div>
</body>
</html>
